Executable test code inspired by @dawei6875797
